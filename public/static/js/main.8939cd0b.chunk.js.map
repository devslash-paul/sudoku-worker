{"version":3,"sources":["state/model.ts","ui/Cell.tsx","ui/Board.tsx","state/cellActions.ts","state/actionTypes.ts","transit.ts","state/default.ts","state/paint.ts","state/history.ts","state/reducer.ts","state/store.ts","ui/sidebar/Controls.tsx","state/sidebarActions.ts","ui/SidePanel.tsx","ui/Skeleton.tsx","ui/ResizeablePanel.tsx","ui/size/sizer.ts","ui/paint/Line.tsx","ui/paint/Painter.tsx","ui/PaintManager.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["State","style","color","boxSizing","textAlign","background","highlightText","fontWeight","Cell","onMouseover","e","buttons","props","nextProps","this","number","selected","small","size","highlight","ninth","extraStyle","flexBasis","cells","fontSize","height","lineHeight","position","padding","justifyItems","alignItems","inside","getLargeCell","getSmallCell","tryStyle","display","gridTemplateColumns","gridTemplateRows","tabIndex","className","onMouseDown","onClick","shiftKey","onKeyDown","onInput","keyCode","metaKey","onMouseMove","onBlur","map","x","thirdSize","Math","floor","s","gridRow","gridColumn","key","onClickText","Error","ex","Component","onMove","selectedState","setSelected","direction","original","values","next","value","selection","res","Set","add","index","doMove","onDelete","val","shift","meta","onEnterSmallNum","Array","from","onEnterNum","FilteredBoard","connect","main","board","settings","boardSize","interact","state","NORMAL","dispatch","num","type","insertCell","insertSmallCell","deleteCell","rowStyle","pointerEvents","flexFlow","width","defaultSelectedCell","useState","highlightState","setHighlight","cell","mainNum","has","focused","huff","reverse","sparseMap","0","1","2","3","4","5","6","7","encodeFull","cellsFilled","runThrough","i","length","indexOf","nextOne","min","filledVals","filter","reduce","p","n","bn","hex","toString","arr","padEnd","push","substring","b64encoded","btoa","String","fromCharCode","apply","parseInt","console","log","replace","bnToB64","BigInt","importFull","atob","idx","boardidx","charAt","undefined","getInitialState","window","location","pathname","startsWith","path","history","pushState","defaultState","frozen","localStorage","getItem","JSON","parse","items","activeItem","paintState","links","paintStart","enableHighlight","paintReducer","action","subtype","PAINTING","doPaint","coordinate","coord","start","subcell","link","end","doSendCoordinate","collapseHistory","events","last","cur","kind","stringify","validStateAction","FROZEN","isPainting","doClearHistory","doResize","data","freeze","doInsert","newCells","large","doImport","isNaN","doChangeHighlight","doSidebar","fill","doInsertSmall","validIdx","adding","forEach","alreadyHas","hist","doDelete","iState","historyItem","newDeleteCells","historyItems","store","createStore","composeWithDevTools","subscribe","setItem","getState","boxStyle","margin","borderRadius","flexGrow","topLeft","borderTopLeftRadius","topRight","borderTopRightRadius","ConnectedControls","painting","full","onNew","onChangeHighlight","onSetHighlight","onChangePainting","onImport","addToast","useToasts","Grid","container","Button","disableElevation","variant","response","prompt","onImportClicked","navigator","clipboard","writeText","host","appearance","autoDismiss","doExport","htmlFor","id","checked","onChange","target","ConnectedPanel","boardCells","clearHistory","href","rel","bodyStyle","boardStyle","sidebarStyle","minWidth","minHeight","maxHeight","overflowY","collapse","right","top","borderBottomRightRadius","Skeleton","side","React","PureComponent","ResizePanel","onDrag","onDragStart","onDragEnd","minConstraints","lockAspectRatio","onResize","onResizeStart","onResizeStop","children","getSmallCoordinatesFromXY","y","xAccrossCell","finalCell","xAccrossSubCell","toCoordinates","coords","largeSize","smallSize","xAccross","yAccross","snapTo","spacing","snap","round","Line","seen","seenStart","seenEnd","startCoords","endCoords","boxSize","centerStartX","centerStartY","centerEndX","centerEndY","startNode","endNode","midPointX","midPointY","d","stroke","defaultStyle","zIndex","lineStyle","setOngoingLine","ongoingLine","SVGElement","rect","getBoundingClientRect","clientX","left","clientY","onSvgClick","setLineState","lineState","startLine","commitLine","line","lines","setLine","setLines","Paint","ongoing","ConnectedPainter","enabled","painter","App","Mainboard","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","config","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","catch","error","ReactDOM","render","document","getElementById","URL","process","origin","addEventListener","fetch","headers","contentType","get","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.8939cd0b.chunk.js","sourcesContent":["export type CellState = {\n    mainNum: number | null,\n    small: Array<number>\n}\n\nexport enum State {\n    NORMAL=1,\n    FROZEN=2,\n    PAINTING=3\n}\n\n/**\n * All events must be reversible, events that are supported are\n * ADD of large number\n * REMOVAL of large number\n * ADDITION of small numbers (one by one)\n * REMOVAL of small numbers (one by one)\n * ADDITION of small numbers (in batch)\n * REMOVAL of small numbers (in batch)\n */\nexport type AppEvent  ={\n    kind: 'ADD' | 'REMOVE',\n    index: Array<number>,\n    large?: number,\n    small?: Array<number>,\n}\n\nexport type Settings = {\n    state: State,\n    enableHighlight: boolean,\n    boardSize: number\n}\n\nexport type Link = {\n    start: Coordinate, \n    end: Coordinate,\n}\n\nexport type Coordinate = {\n    cell: number;\n    subcell: number;\n}\n\nexport type PaintState = {\n    links: Array<Link>,\n    paintStart: Coordinate | null,\n}\n\nexport type History = {\n    items: Array<AppEvent>,\n    activeItem: number,\n}\n\nexport type AppState = {\n    cells: Array<CellState>,\n    settings: Settings,\n    paintState: PaintState,\n    history: History,\n}","import React, { Component } from \"react\";\nimport CSS from \"csstype\";\n\ntype CellProps = {\n  number: number | null;\n  small: Array<number>;\n  cells: number;\n  selected: boolean;\n  focused: boolean;\n  highlight: number | null;\n  size: number;\n  onClick: (meta: boolean) => void;\n  onClickText: (number: number) => void;\n  onInput: (arg0: number, shift: boolean, meta: boolean) => void;\n  onBlur: () => void;\n  onMouseover: () => void;\n};\n\nconst style: CSS.Properties = {\n  color: \"black\",\n  boxSizing: \"border-box\",\n  textAlign: \"center\",\n  background: \"white\",\n};\nconst highlightText: CSS.Properties = {\n  color: \"red\",\n  fontWeight: \"bold\"\n  // background: \"yellow\"\n};\n\nexport class Cell extends Component<CellProps> {\n  shouldComponentUpdate(nextProps: CellProps): boolean {\n    return (\n      this.props.number !== nextProps.number ||\n      this.props.selected !== nextProps.selected ||\n      this.props.small !== nextProps.small ||\n      this.props.size !== nextProps.size ||\n      this.props.highlight !== nextProps.highlight\n    );\n  }\n\n  onMouseover = (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n    if (e.buttons && 0x1) {\n      this.props.onMouseover();\n    }\n  };\n\n  render() {\n    const ninth = this.props.size;\n    const extraStyle: CSS.Properties = {\n      ...style,\n      flexBasis: \"calc(100%/\" + this.props.cells + \")\",\n      fontSize: `${ninth - 10}px`,\n      height: `${ninth}px`,\n      lineHeight: `${ninth}px`,\n      position: \"relative\",\n      padding: '2px',\n      justifyItems: 'center',\n      alignItems: 'center',\n      background: this.props.selected ? \"rgba(0,0,255,0.2)\" : \"white\"\n    };\n\n    const inside = this.props.number\n      ? this.getLargeCell()\n      : this.getSmallCell();\n\n    const tryStyle: CSS.Properties = {\n      ...extraStyle,\n      display: 'grid',\n      gridTemplateColumns: '33% 34% 33%',\n      gridTemplateRows: '33% 34% 33%',\n    }\n\n    return (\n      <div\n        tabIndex={0}\n        style={tryStyle}\n        className=\"tile\"\n\n        onMouseDown={e => this.props.onClick(e.shiftKey)}\n        onKeyDown={e => this.props.onInput(e.keyCode, e.shiftKey, e.metaKey)}\n        onMouseMove={this.onMouseover}\n        onBlur={this.props.onBlur}\n      >\n        {inside}\n      </div>\n    );\n  }\n\n  private getSmallCell() {\n    return this.props.small.map(x => {\n      const clickHandler = () => this.props.onClickText(x);\n      const thirdSize = Math.floor(this.props.size / 4);\n      let s: React.CSSProperties = {\n        fontSize: `${thirdSize}px`,\n        height: `${thirdSize}px`,\n        lineHeight: `${thirdSize}px`,\n        gridRow: `${Math.floor((x-1)/3) + 1}`,\n        gridColumn: ((x-1)%3) + 1,\n      };\n      if (this.props.highlight === x) {\n        s = {\n          ...s,\n          ...highlightText\n        };\n      }\n      return (\n        <div key={x} style={s} className=\"smallContent\" onClick={clickHandler}>\n          {x}\n        </div>\n      );\n    });\n  }\n\n  private getLargeCell() {\n    if (this.props.number == null) {\n      throw Error();\n    }\n    const clickHandler = () =>\n      this.props.number && this.props.onClickText(this.props.number);\n    const highlight = this.props.highlight === this.props.number;\n    const style = highlight ? highlightText : {};\n    const ex = {\n      ...style,\n      gridRow: '1/4',\n      gridColumn: '1/4',\n    }\n    return (\n      <div className=\"content\" onClick={clickHandler} style={ex}>\n        {this.props.number}\n      </div>\n    );\n  }\n}\n","import React, { Dispatch, useState } from \"react\";\nimport { AppState, CellState, State } from \"../state/model\";\nimport CSS from \"csstype\";\nimport {\n  insertCell,\n  insertSmallCell,\n  Actions,\n  deleteCell,\n  Direction\n} from \"../state/cellActions\";\nimport { connect } from \"react-redux\";\nimport { Cell } from \"./Cell\";\n\ntype BoardProps = {\n  board: Array<CellState>;\n  size: number;\n  interact: boolean;\n  onEnterNum: (index: number, num: number) => void;\n  onEnterSmallNum: (index: Array<number>, num: number) => void;\n  onDelete: (index: Set<number>) => void;\n};\n\nconst onMove = (\n  selectedState: Set<number>,\n  setSelected: Dispatch<React.SetStateAction<Set<number>>>\n) => {\n  return (direction: Direction) => {\n    if (selectedState.size !== 1) {\n      return;\n    }\n\n    let original = selectedState.values().next().value;\n    let selection = original;\n    switch (direction) {\n      case \"UP\":\n        selection -= 9;\n        break;\n      case \"DOWN\":\n        selection += 9;\n        break;\n      case \"LEFT\":\n        selection -= 1;\n        break;\n      case \"RIGHT\":\n        selection += 1;\n        break;\n    }\n    if (selection <= -1) selection = original;\n    if (selection >= 81) selection = original;\n    const res: Set<number> = new Set();\n    res.add(selection);\n    setSelected(res);\n  };\n};\n\nconst onInput = (\n  index: number,\n  selectedState: Set<number>,\n  doMove: (d: Direction) => void,\n  onDelete: (idx: Set<number>) => void,\n  props: BoardProps\n) => {\n  return (val: number, shift: boolean, meta: boolean) => {\n    if (val === 46 || val === 8) {\n      return onDelete(selectedState);\n    }\n    if(meta) {\n      return;\n    }\n    if ((val >= 49 && val <= 57) || (val >= 97 && val <= 105)) {\n      // we have a number entered. Lets quickly normalize the numpad\n      if (val > 57) {\n        val -= 48;\n      }\n      val -= 48;\n      if (!shift && selectedState.size === 1) {\n        props.onEnterNum(selectedState.values().next().value, val);\n      } else if (shift) {\n        props.onEnterSmallNum(Array.from(selectedState), val);\n      }\n    } else if (val === 8 || val === 46) {\n      return onDelete(selectedState);\n    }\n    if (selectedState.size === 1) {\n      if (val === 38) {\n        return doMove(\"UP\");\n      } else if (val === 37) {\n        return doMove(\"LEFT\");\n      } else if (val === 40) {\n        return doMove(\"DOWN\");\n      } else if (val === 39) {\n        return doMove(\"RIGHT\");\n      }\n    }\n  };\n};\n\ntype Highlight = number | null;\n\nexport const BoardUI = (props: BoardProps) => {\n  const rowStyle: CSS.Properties = {\n    display: \"flex\",\n    pointerEvents: \"all\",\n    flexFlow: \"row wrap\",\n    width: `${props.size}px`,\n    lineHeight: `${props.size}px`\n  };\n  const { interact } = props;\n  const defaultSelectedCell: Set<number> = new Set();\n  const [selectedState, setSelected] = useState(defaultSelectedCell);\n  const [highlightState, setHighlight] = useState<Highlight>(null);\n\n  const board = props.board;\n  let cells = board.map((cell, index) => {\n    const onDrag = () => {\n      if (!interact) {\n        return;\n      }\n      const res = new Set(selectedState);\n      res.add(index);\n      setSelected(res);\n    };\n    const onBlur = () => {\n      if (!interact) {\n        return;\n      }\n      setHighlight(null);\n    };\n    const onClickText = (val: number) => {\n      if (!interact) {\n        return;\n      }\n      setHighlight(val);\n    };\n    const select = (meta: boolean) => {\n      if (!interact) {\n        return;\n      }\n      if (!meta) {\n        const res: Set<number> = new Set();\n        res.add(index);\n        setSelected(res);\n      } else {\n        const res = new Set(selectedState);\n        res.add(index);\n        setSelected(res);\n      }\n    };\n    return (\n      <Cell\n        key={index}\n        number={cell.mainNum}\n        small={cell.small}\n        cells={9}\n        size={props.size / 9}\n        highlight={highlightState}\n        selected={selectedState.has(index)}\n        focused={selectedState.has(index) && selectedState.size === 1}\n        onClickText={onClickText}\n        onClick={select}\n        onBlur={onBlur}\n        onInput={onInput(\n          index,\n          selectedState,\n          onMove(selectedState, setSelected),\n          props.onDelete,\n          props\n        )}\n        onMouseover={onDrag}\n      />\n    );\n  });\n  return (\n    <div tabIndex={1} className=\"box\" style={rowStyle}>\n      {cells}\n    </div>\n  );\n};\n\nconst mapStateToProps = (main: AppState) => {\n  return {\n    board: main.cells,\n    size: main.settings.boardSize,\n    interact: main.settings.state === State.NORMAL\n  };\n};\n\nconst mapDispatchToProps = (dispatch: Dispatch<Actions>) => {\n  return {\n    onEnterNum: (index: number, num: number) => {\n      dispatch(insertCell(index, num));\n    },\n    onEnterSmallNum: (index: Array<number>, num: number) => {\n      dispatch(insertSmallCell(index, num));\n    },\n    onDelete: (index: Set<number>) => {\n      dispatch(deleteCell(index));\n    }\n  };\n};\n\nexport const FilteredBoard = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(BoardUI);\n","import {\n  INSERT,\n  INSERT_SMALL,\n  DELETE,\n  DRAG_CELL,\n  SIDEBAR,\n  BLUR_CELL,\n  MOVE,\n  CLICK_TEXT,\n  NEW,\n  HIGHLIGHT_CHANGE,\n  IMPORT,\n  RESIZE,\n  RESIZE_START,\n  PAINT,\n  RESIZE_END,\n  BEGIN_PAINTING,\n  END_PAINTING,\n  SEND_COORDINATE,\n  CLEAR_HISTORY\n} from \"./actionTypes\";\nimport { Coordinate } from \"./model\";\n\nexport type Actions =\n  | InsertEvent\n  | InsertSmallEvent\n  | DeleteEvent\n  | ResizeEvent\n  | SidebarEvent\n  | HighlightChangeEvent\n  | ImportEvent\n  | CoordinateEvent\n  | PaintEvent\n  | ClearHistoryEvent;\n\nexport type CoordinateEvent = {\n  type: typeof SEND_COORDINATE;\n  coordinate: Coordinate;\n};\n\nexport type Direction = \"UP\" | \"DOWN\" | \"LEFT\" | \"RIGHT\";\n\nexport type PaintEvent = {\n  type: typeof PAINT;\n  subtype: typeof BEGIN_PAINTING | typeof END_PAINTING;\n};\nexport type ImportEvent = {\n  type: typeof IMPORT;\n  value: string;\n};\nexport type ClearHistoryEvent = {\n  type: typeof CLEAR_HISTORY;\n}\nexport type SidebarEvent = {\n  type: typeof SIDEBAR;\n  subtype: typeof NEW;\n};\n\nexport type HighlightChangeEvent = {\n  type: typeof HIGHLIGHT_CHANGE;\n  value: boolean;\n};\n\nexport type ClickTextEvent = {\n  type: typeof CLICK_TEXT;\n  index: number;\n  number: number;\n};\n\nexport type MoveEvent = {\n  type: typeof MOVE;\n  direction: Direction;\n};\nexport type BlurEvent = {\n  type: typeof BLUR_CELL;\n  index: number;\n};\nexport type DragCellEvent = {\n  type: typeof DRAG_CELL;\n  index: number;\n};\nexport type InsertSmallEvent = {\n  type: typeof INSERT_SMALL;\n  index: Array<number>;\n  number: number;\n};\nexport type InsertEvent = {\n  type: typeof INSERT;\n  index: number;\n  number: number;\n};\n\nexport type DeleteEvent = {\n  type: typeof DELETE;\n  index: Set<number>;\n};\nexport type ResizeEvent =\n  | {\n      type: typeof RESIZE;\n      size: number;\n    }\n  | {\n      type: typeof RESIZE_START | typeof RESIZE_END;\n    };\n\nexport function resize(size: number): ResizeEvent {\n  return {\n    type: RESIZE,\n    size\n  };\n}\n\nexport function insertCell(index: number, number: number): InsertEvent {\n  return {\n    type: INSERT,\n    index,\n    number\n  };\n}\n\nexport function insertSmallCell(\n  index: Array<number>,\n  number: number\n): InsertSmallEvent {\n  return {\n    type: INSERT_SMALL,\n    number,\n    index\n  };\n}\n\nexport function deleteCell(index: Set<number>): DeleteEvent {\n  return {\n    type: DELETE,\n    index\n  };\n}\n","export const SELECT_CELL = \"SELECT_CELL\";\nexport const INSERT = \"INSERT\";\nexport const INSERT_SMALL = \"INSERT_SMALL\";\nexport const DELETE = \"DELETE\";\nexport const DRAG_CELL = \"DRAG_CELL\";\nexport const BLUR_CELL = \"BLUR_CELL\";\n\nexport const CLEAR_HISTORY = \"CLEAR_HISTORY\";\n\nexport const MOVE = \"MOVE\";\n\nexport const CLICK_TEXT = \"CLICK_TEXT\";\nexport const DOUBLE_CLICK_TEXT = \"DOUBLE_CLICK_TEXT\";\n\nexport const SIDEBAR = \"SIDEBAR\";\nexport const NEW = \"NEW\";\nexport const HIGHLIGHT_CHANGE = \"HIGHLIGHT_CHANGE\";\nexport const IMPORT = \"IMPORT\";\n\nexport const RESIZE = \"RESIZE\";\nexport const RESIZE_START = \"RESIZE_START\";\nexport const RESIZE_END = \"RESIZE_END\";\n\nexport const PAINT = \"PAINT\"\nexport const BEGIN_PAINTING = \"BEGIN_PAINING\"\nexport const END_PAINTING = \"END_PAINING\"\nexport const SEND_COORDINATE = \"SEND_COORD\"","import { CellState } from './state/model'\n\nconst huff: Record<string, number> = {\n    '000': 0,\n    '1111': 1,\n    '001': 2,\n    '010': 3,\n    '011': 4,\n    '100': 5,\n    '101': 6,\n    '1100': 7,\n    '1101': 8,\n    '1110': 9,\n}\n\nconst reverse: Record<string, string> = {\n    '0': '000',\n    '1': '1111',\n    '2': '001',\n    '3': '010',\n    '4': '011',\n    '5': '100',\n    '6': '101',\n    '7': '1100',\n    '8': '1101',\n    '9': '1110',\n}\n\nconst sparseMap: Record<number, string> = {\n    0: '000',\n    1: '001',\n    2: '010',\n    3: '011',\n    4: '100',\n    5: '101',\n    6: '110',\n    7: '111',\n}\n\nexport function encodeFull(cells: CellState[]) {\n    // algo 2 start\n    const cellsFilled = cells.map(x => x.mainNum == null ? 0 : 1)\n    let runThrough = \"\";\n    let i = 0;\n    while (i < cellsFilled.length) {\n        // if this is a one, add it\n        if (cellsFilled[i] === 1) {\n            runThrough += sparseMap[0]\n            i++;\n        } else {\n            // how many zeros in a row\n            if (cellsFilled.indexOf(1, i) === -1) {\n                // there are no more cells filled. Pick the largest possible\n                let nextOne = Math.min(7, cellsFilled.length - i)\n                runThrough += sparseMap[nextOne]\n                i += nextOne\n            } else {\n                let nextOne = Math.min(cellsFilled.indexOf(1, i), 7)\n                runThrough += sparseMap[nextOne]\n                i += nextOne\n            }\n        }\n        // something went wrong\n        if (i > 90) {\n            break;\n        }\n    }\n    const filledVals = cells.filter(x => x.mainNum != null)\n        .map(x => x.mainNum)\n        .map(x => reverse[\"\" + x])\n        .reduce((p, n) => p + n, \"\")\n    const val2 = BigInt(\"0b\" + runThrough + filledVals)\n    // algo 2 end\n    return bnToB64(val2)\n};\n\nfunction bnToB64(bn: BigInt) {\n    let hex = bn.toString(2);\n    let arr = []\n    if (hex.length % 8 > 0) {\n        hex = hex.padEnd(hex.length + (8 - (hex.length % 8)), \"0\")\n    }\n    for (var i = 0; i < hex.length / 8; i++) {\n        arr.push(hex.substring(i * 8, i * 8 + 8))\n    }\n    var b64encoded = btoa(String.fromCharCode.apply(null, arr.map(x => parseInt(x, 2))));\n    console.log(b64encoded)\n\n    return b64encoded.replace(/\\//g, \"-\").replace(/\\+/g, \"_\").replace(/=/g, \"\")\n}\n\nexport function importFull(board: string): CellState[] {\n    console.log(atob(board.replace(/-/g, \"\\/\")))\n    const res = (BigInt(\"0x\" + board).toString(2))\n    const arr = new Array(81);\n    let idx = 0;\n    let s = ''\n    let boardidx = 0;\n    while (idx < 81) {\n        s = s + res.charAt(boardidx)\n        boardidx++;\n        if (huff[s] !== undefined) {\n            arr[idx++] = {\n                mainNum: huff[s],\n                small: []\n            }\n            s = ''\n        }\n    }\n    return arr;\n}","import { AppState, State } from \"./model\";\nimport { importFull } from \"../transit\";\n\nexport const getInitialState = () => {\n  if(window.location.pathname.startsWith(\"/share/\")) {\n    let path = window.location.pathname.substring(\"/share/\".length)\n    window.history.pushState({}, \"Sudoku UI\", \"/\")\n    return {\n      ...defaultState, \n      settings: {\n        ...defaultState.settings, \n        frozen: false,\n      },\n      cells: importFull(path)\n    }\n  }\n  const res =localStorage.getItem('state');\n  if (res != null) {\n    return JSON.parse(res);\n  }\n  return {\n    ...defaultState,\n    settings: {\n      ...defaultState.settings,\n      frozen: false // you can never load a frozen state\n    }\n  }\n}\n\nconst defaultState: AppState = {\n  history: {\n    items: [],\n    activeItem: -1,\n  },\n  paintState: {\n    links: [],\n    paintStart: null,\n  },\n  settings: {\n    state: State.NORMAL,\n    enableHighlight: false,\n    boardSize: 450,\n  },\n  cells: [\n    {\n      mainNum: 9,\n      small: []\n    },\n    {\n      mainNum: null,\n      small: [2, 1, 3]\n    },\n    {\n      mainNum: null,\n      small: [2, 1, 3]\n    },\n    {\n      mainNum: null,\n      small: [4, 6, 1]\n    },\n    {\n      mainNum: 5,\n      small: []\n    },\n    {\n      mainNum: null,\n      small: [4, 1, 7]\n    },\n    {\n      mainNum: null,\n      small: [3, 7]\n    },\n    {\n      mainNum: 8,\n      small: []\n    },\n    {\n      mainNum: null,\n      small: [6, 1, 7]\n    },\n    {\n      mainNum: null,\n      small: [1, 3, 5]\n    },\n    {\n      mainNum: 4,\n      small: [4]\n    },\n    {\n      mainNum: 8,\n      small: []\n    },\n    {\n      mainNum: null,\n      small: [6, 1, 2]\n    },\n    {\n      mainNum: null,\n      small: [2, 7]\n    },\n    {\n      mainNum: null,\n      small: [1, 2, 7]\n    },\n    {\n      mainNum: 9,\n      small: []\n    },\n    {\n      mainNum: null,\n      small: [3, 5, 1]\n    },\n    {\n      mainNum: null,\n      small: [6, 1, 7]\n    },\n    {\n      mainNum: null,\n      small: [7, 1, 5]\n    },\n    {\n      mainNum: 6,\n      small: [6]\n    },\n    {\n      mainNum: null,\n      small: [7, 1, 5]\n    },\n    {\n      mainNum: 3,\n      small: []\n    },\n    {\n      mainNum: null,\n      small: [8, 9]\n    },\n    {\n      mainNum: null,\n      small: [8, 9]\n    },\n    {\n      mainNum: 2,\n      small: []\n    },\n    {\n      mainNum: null,\n      small: [5, 1]\n    },\n    {\n      mainNum: 4,\n      small: []\n    },\n    {\n      mainNum: null,\n      small: [1, 8]\n    },\n    {\n      mainNum: null,\n      small: [1, 2, 3, 8]\n    },\n    {\n      mainNum: null,\n      small: [1, 2, 3]\n    },\n    {\n      mainNum: 7,\n      small: []\n    },\n    {\n      mainNum: null,\n      small: [9, 2, 4, 8]\n    },\n    {\n      mainNum: null,\n      small: [1, 9, 2, 4, 8]\n    },\n    {\n      mainNum: null,\n      small: [3, 4]\n    },\n    {\n      mainNum: 6,\n      small: []\n    },\n    {\n      mainNum: 5,\n      small: []\n    },\n    {\n      mainNum: null,\n      small: [7, 5, 3, 8]\n    },\n    {\n      mainNum: null,\n      small: [7, 2, 3, 8]\n    },\n    {\n      mainNum: 6,\n      small: []\n    },\n    {\n      mainNum: null,\n      small: [5, 2, 4, 8]\n    },\n    {\n      mainNum: null,\n      small: [2, 4, 8]\n    },\n    {\n      mainNum: null,\n      small: [2, 4, 8]\n    },\n    {\n      mainNum: 1,\n      small: []\n    },\n    {\n      mainNum: null,\n      small: [3, 4]\n    },\n    {\n      mainNum: 9,\n      small: []\n    },\n    {\n      mainNum: 4,\n      small: []\n    },\n    {\n      mainNum: 9,\n      small: []\n    },\n    {\n      mainNum: null,\n      small: [5, 1]\n    },\n    {\n      mainNum: null,\n      small: [1, 5]\n    },\n    {\n      mainNum: 6,\n      small: [6]\n    },\n    {\n      mainNum: 3,\n      small: []\n    },\n    {\n      mainNum: null,\n      small: [7, 8]\n    },\n    {\n      mainNum: 2,\n      small: [2]\n    },\n    {\n      mainNum: null,\n      small: [7, 8]\n    },\n    {\n      mainNum: 2,\n      small: []\n    },\n    {\n      mainNum: null,\n      small: [3, 7, 8]\n    },\n    {\n      mainNum: 9,\n      small: []\n    },\n    {\n      mainNum: null,\n      small: [4, 7, 8]\n    },\n    {\n      mainNum: null,\n      small: [3, 4, 7, 8]\n    },\n    {\n      mainNum: 6,\n      small: []\n    },\n    {\n      mainNum: 5,\n      small: [5]\n    },\n    {\n      mainNum: null,\n      small: [1, 4]\n    },\n    {\n      mainNum: null,\n      small: [1, 8]\n    },\n    {\n      mainNum: null,\n      small: [1, 3, 8]\n    },\n    {\n      mainNum: null,\n      small: [1, 3, 8]\n    },\n    {\n      mainNum: 4,\n      small: []\n    },\n    {\n      mainNum: 9,\n      small: [5]\n    },\n    {\n      mainNum: null,\n      small: [3, 8]\n    },\n    {\n      mainNum: 5,\n      small: [5]\n    },\n    {\n      mainNum: 6,\n      small: []\n    },\n    {\n      mainNum: 7,\n      small: []\n    },\n    {\n      mainNum: 2,\n      small: [2]\n    },\n    {\n      mainNum: 6,\n      small: []\n    },\n    {\n      mainNum: 5,\n      small: []\n    },\n    {\n      mainNum: null,\n      small: [7, 8]\n    },\n    {\n      mainNum: null,\n      small: [2, 4, 7, 8]\n    },\n    {\n      mainNum: 1,\n      small: []\n    },\n    {\n      mainNum: null,\n      small: [2, 4, 7, 8]\n    },\n    {\n      mainNum: null,\n      small: [4, 8]\n    },\n    {\n      mainNum: 9,\n      small: [2]\n    },\n    {\n      mainNum: 3,\n      small: []\n    }\n  ],\n};\n","import { AppState, State } from \"./model\";\nimport { PaintEvent, Actions, CoordinateEvent } from \"./cellActions\";\nimport {\n  BEGIN_PAINTING,\n  PAINT,\n  END_PAINTING,\n  SEND_COORDINATE\n} from \"./actionTypes\";\n\nexport function paintReducer(state: AppState, action: Actions): AppState {\n  switch (action.type) {\n    case PAINT:\n      return doPaint(state, action);\n    case SEND_COORDINATE:\n      return doSendCoordinate(state, action);\n  }\n  return {\n    ...state\n  };\n}\n\nfunction doSendCoordinate(state: AppState, action: CoordinateEvent) {\n  // we have to check the coordinate has a small in it\n  const cell = state.cells[action.coordinate.cell];\n  const small = cell.small;\n  const coord = action.coordinate;\n  const start = state.paintState.paintStart;\n  if (\n    start == null ||\n    cell.mainNum != null ||\n    small.indexOf(action.coordinate.subcell + 1) === -1\n  ) {\n    return state;\n  }\n  if (action.coordinate === state.paintState.paintStart) {\n    // Lets flip the color, or cancel if nothing there.\n    const links = [...state.paintState.links];\n    return {\n      ...state,\n      paintState: {\n        ...state.paintState,\n        links,\n        paintStart: null\n      }\n    };\n  }\n  const link = {\n    start: start,\n    end: coord\n  };\n  return {\n    ...state,\n    paintState: {\n      ...state.paintState,\n      links: [...state.paintState.links, link],\n      paintStart: null\n    }\n  };\n}\n\nfunction doPaint(state: AppState, action: PaintEvent): AppState {\n  switch (action.subtype) {\n    case BEGIN_PAINTING:\n      return {\n        ...state,\n        settings: {\n          ...state.settings,\n          state: State.PAINTING\n        }\n      };\n    case END_PAINTING:\n      return {\n        ...state,\n        settings: {\n          ...state.settings,\n          state: State.NORMAL\n        },\n        paintState: {\n          links: [],\n          paintStart: null\n        }\n      };\n  }\n}\n","import { AppEvent } from \"./model\";\n\nexport const collapseHistory = (events: Array<AppEvent>) => {\n    let last: AppEvent | null = null;\n    let res: Array<AppEvent> = [];\n    if (events.length === 0) {\n        return [];\n    }\n\n    for (let i = 0; i < events.length; i++) {\n        if (last === null) {\n            last = events[i]\n            continue\n        }\n        let cur = events[i]\n        if (last.kind === cur.kind && JSON.stringify(last.small) === JSON.stringify(cur.small)) {\n            last = {\n                ...last,\n                index: [...last.index, ...cur.index]\n            }\n        } else {\n            res.push(last)\n            last = cur;\n        }\n    }\n    if (last !== null) {\n        res.push(last)\n    }\n    return res;\n}\n\nexport const collapseUndo = (events: Array<AppEvent>) => {\n    // this can only happen on the last two\n    if (events.length < 2) {\n        return events;\n    }\n\n    var last = events[events.length - 1]\n    var snd = events[events.length - 2]\n\n    if ((last.kind === \"ADD\" && snd.kind === \"REMOVE\") ||\n        (last.kind === \"REMOVE\" && snd.kind === \"ADD\")) {\n        if (last.large === snd.large && JSON.stringify(last.small) === JSON.stringify(snd.small)\n            && JSON.stringify(last.index) === JSON.stringify(snd.index)) {\n            // they're an undo of the other\n            return events.slice(0, events.length - 2)\n        }\n    }\n    return events\n}","import { AppState, State, AppEvent } from \"./model\";\nimport {\n  Actions,\n  InsertSmallEvent,\n  SidebarEvent,\n  DeleteEvent,\n  ResizeEvent\n} from \"./cellActions\";\nimport { getInitialState } from \"./default\";\nimport {\n  SIDEBAR,\n  NEW,\n  HIGHLIGHT_CHANGE,\n  IMPORT,\n  RESIZE,\n  RESIZE_START,\n  RESIZE_END,\n  PAINT,\n  INSERT_SMALL,\n  INSERT,\n  DELETE,\n  CLEAR_HISTORY\n} from \"./actionTypes\";\nimport { paintReducer } from \"./paint\";\nimport { collapseHistory } from \"./history\";\n\nconst validStateAction = (state: State, action: Actions) => {\n  switch (state) {\n    case State.NORMAL:\n      // All things can happen when state is normal\n      return true;\n    case State.FROZEN:\n      return (\n        action.type === RESIZE ||\n        action.type === RESIZE_END ||\n        action.type === RESIZE_START\n      );\n  }\n  return true;\n};\n\nfunction isPainting(state: AppState, action: Actions) {\n  return state.settings.state === State.PAINTING || action.type === PAINT;\n}\n\nexport function AppReducer(\n  state: AppState = getInitialState(),\n  action: Actions\n): AppState {\n  if (!validStateAction(state.settings.state, action)) {\n    return state;\n  }\n\n  if (isPainting(state, action)) {\n    return paintReducer(state, action);\n  }\n\n  switch (action.type) {\n    case RESIZE:\n    case RESIZE_START:\n    case RESIZE_END:\n      return doResize(state, action);\n    case INSERT:\n      return doInsert(state, action.index, action.number);\n    case INSERT_SMALL:\n      return doInsertSmall(state, action);\n    case DELETE:\n      return doDelete(state, action);\n    case HIGHLIGHT_CHANGE:\n      return doChangeHighlight(state, action.value);\n    case SIDEBAR:\n      return doSidebar(state, action);\n    case IMPORT:\n      return doImport(state, action.value);\n    case CLEAR_HISTORY: \n      return doClearHistory(state);\n    default:\n      return state;\n  }\n}\n\nfunction doClearHistory(state: AppState) : AppState {\n  return {\n    ...state,\n    history: {\n      items: [],\n      activeItem: -1\n    }\n  }\n}\n\nfunction doResize(state: AppState, data: ResizeEvent): AppState {\n  if (data.type === RESIZE) {\n    return {\n      ...state,\n      settings: {\n        ...state.settings,\n        boardSize: data.size\n      }\n    };\n  }\n  const freeze = data.type === RESIZE_START;\n  return {\n    ...state,\n    settings: {\n      ...state.settings,\n      state: freeze ? State.FROZEN : State.NORMAL\n    }\n  };\n}\n\nfunction doInsert(state: AppState, idx: number, value: number): AppState {\n  // only works with a single selection\n  const newCells = [...state.cells];\n  const cell = newCells[idx];\n\n  if(cell.mainNum === value) {\n    // no op\n    return state;\n  }\n\n  newCells[idx] = { ...cell, mainNum: value };\n  const history: Array<AppEvent> = [...state.history.items, { kind: \"ADD\", large: value, index: [idx] }]\n  return { ...state, cells: newCells, history: {\n    items: history,\n    activeItem: history.length - 1\n  } };\n}\n\nfunction doImport(state: AppState, value: string): AppState {\n  let cells = new Array(81);\n  for (let i = 0; i < 81; i++) {\n    if (value.charAt(i) !== \"0\" && !isNaN(parseInt(value.charAt(i)))) {\n      cells[i] = { mainNum: parseInt(value.charAt(i)), small: [] };\n    } else {\n      cells[i] = { mainNum: null, small: [] };\n    }\n  }\n  return {\n    ...state,\n    cells\n  };\n}\n\nfunction doChangeHighlight(state: AppState, value: boolean): AppState {\n  return {\n    ...state,\n    settings: {\n      ...state.settings,\n      enableHighlight: value\n    }\n  };\n}\n\nfunction doSidebar(state: AppState, action: SidebarEvent): AppState {\n  switch (action.subtype) {\n    case NEW:\n      const newCells = new Array(81).fill({ mainNum: null, small: [] });\n      return {\n        ...state,\n        cells: newCells,\n        history: {items: [], activeItem: -1}\n      };\n  }\n}\n\nfunction doInsertSmall(state: AppState, action: InsertSmallEvent) : AppState {\n  const cells = [...state.cells];\n  const validIdx = action.index.filter(x => cells[x].mainNum == null)\n  const adding = validIdx\n    .map(x => cells[x].small.indexOf(action.number) === -1)\n    .reduce((p, n) => p || n, false);\n\n  validIdx.forEach(index => {\n    const alreadyHas = cells[index].small.indexOf(action.number) !== -1;\n    if (adding && !alreadyHas) {\n      cells[index] = {\n        ...cells[index],\n        small: [...cells[index].small, action.number]\n      };\n    } else if (!adding && alreadyHas) {\n      cells[index] = {\n        ...cells[index],\n        small: cells[index].small.filter(s => s !== action.number)\n      };\n    }\n  });\n  const hist: Array<AppEvent> = validIdx.map(i => {\n    return {\n      kind: adding ? \"ADD\": \"REMOVE\",\n      index: [i],\n      small: [action.number]\n    }\n  })\n  const history = [...state.history.items, ...collapseHistory(hist)];\n  return {\n    ...state, \n    cells: [...cells],\n    history: {\n      items: history,\n      activeItem: history.length - 1,\n    }\n  };\n}\n\nfunction doDelete(state: AppState, action: DeleteEvent) {\n  let iState = [...state.cells];\n  let historyItem: Array<AppEvent> = [];\n  action.index.forEach(idx => {\n    let deleteCell = state.cells[idx];\n    const newDeleteCells = [...iState];\n    if (deleteCell.mainNum == null) {\n      historyItem.push({kind: \"REMOVE\", index: [idx], small: deleteCell.small})\n      deleteCell = {\n        ...deleteCell,\n        small: []\n      };\n    } else {\n      historyItem.push({kind: \"REMOVE\", index: [idx], large: deleteCell.mainNum})\n      deleteCell = {\n        ...deleteCell,\n        mainNum: null\n      };\n    }\n    newDeleteCells[idx] = deleteCell;\n    iState = [...newDeleteCells];\n  });\n  const historyItems: Array<AppEvent> = [...state.history.items, ...collapseHistory(historyItem)]\n\n  return {\n    ...state,\n    cells: iState,\n    history: {\n      ...state.history,\n      items: historyItems,\n      activeItem: historyItems.length - 1\n    },\n  };\n}\n","import { AppReducer } from \"./reducer\";\nimport { createStore } from \"redux\";\nimport { composeWithDevTools } from 'redux-devtools-extension';\n\nexport const store = createStore(\n  AppReducer,\n  composeWithDevTools()\n);\n\nstore.subscribe(() => localStorage.setItem(\"state\", JSON.stringify(store.getState())));","import React, { Dispatch } from \"react\";\nimport { encodeFull } from \"../../transit\";\nimport { connect } from \"react-redux\";\nimport { AppState, State, Settings } from \"../../state/model\";\nimport { Actions } from \"../../state/cellActions\";\nimport { Grid, Button } from \"@material-ui/core\";\nimport { ToggleButtonGroup, ToggleButton } from \"@material-ui/lab\";\nimport CSS from \"csstype\";\nimport { Cell } from \"../Cell\";\nimport { useToasts } from \"react-toast-notifications\";\nimport {\n  onNew,\n  onSetHighlight,\n  onChangePainting,\n  onImport\n} from \"../../state/sidebarActions\";\n\nconst buttonWidth = 33;\nconst cellStyle: CSS.Properties = {\n  boxSizing: \"border-box\",\n  background: \"white\",\n  height: buttonWidth + \"px\",\n  width: buttonWidth + \"px\",\n  border: \"1px solid black\",\n  lineHeight: buttonWidth + \"px\",\n  fontSize: buttonWidth / 1.2 + \"px\"\n};\n\nconst boxStyle: CSS.Properties = {\n  margin: \"0px\",\n  borderRadius: \"0\",\n  background: '#f2f2f2',\n  boxSizing: \"border-box\",\n  flexGrow: 1,\n};\nconst topLeft: CSS.Properties = {\n  borderTopLeftRadius: \"10px\",\n};\nconst topRight: CSS.Properties = {\n  borderTopRightRadius: \"10px\",\n};\n\nconst onImportClicked = (doImport: (e1: string) => void) => {\n  const response = window.prompt(\"Please enter the sodoku: \");\n  if (response !== null) {\n    doImport(response);\n  }\n};\n\nconst doExport = (addToast: any, board: () => string) => {\n  navigator.clipboard.writeText(window.location.host + \"/share/\" + board());\n  addToast(\"URL copied to clipboard\", {\n    appearance: \"info\",\n    autoDismiss: true\n  });\n};\n\ntype ControlProps = {\n  painting: boolean;\n  settings: Settings;\n\n  full: () => string;\n  onNew: () => void;\n  onChangeHighlight: (e1: boolean) => void;\n  onChangePainting: (e1: boolean) => void;\n  doImport: (board: string) => void;\n};\n\nconst Controls = (props: ControlProps) => {\n  const { addToast } = useToasts();\n  const vfun = (e: any) => {};\n  const vof = () => {};\n\n  return (\n    <>\n      <Grid container>\n        <Button\n          disableElevation\n          style={{ ...boxStyle, ...topLeft }}\n          variant=\"outlined\"\n          onClick={props.onNew}\n        >\n          New\n        </Button>\n        <Button\n          disableElevation\n          style={boxStyle}\n          variant=\"outlined\"\n          onClick={e => onImportClicked(props.doImport)}\n        >\n          Import\n        </Button>\n        <Button\n          disableElevation\n          style={{ ...boxStyle, ...topRight }}\n          variant=\"outlined\"\n          onClick={() => doExport(addToast, props.full)}\n        >\n          Share\n        </Button>\n      </Grid>\n      {/* <Grid>\n        <Button variant=\"outlined\" style={boxStyle} disableElevation>\n          <span style={cellStyle}>\n            <div>1</div>\n          </span>\n        </Button>\n        <Button variant=\"outlined\" style={boxStyle} disableElevation>\n          <Cell\n            number={null}\n            small={[1, 2, 3, 4, 5, 6, 7, 8, 9]}\n            selected={false}\n            focused={false}\n            size={buttonWidth}\n            cells={1}\n            highlight={null}\n            onClick={vfun}\n            onClickText={vfun}\n            onBlur={vof}\n            onMouseover={vof}\n            onInput={vfun}\n          />\n        </Button>\n      </Grid> */}\n      <div>\n        <label htmlFor=\"highlight\">Enable Highlights</label>\n        <input\n          id=\"highlight\"\n          type=\"checkbox\"\n          checked={props.settings.enableHighlight}\n          onChange={e => props.onChangeHighlight(e.target.checked)}\n        />\n      </div>\n      <div>\n        <label htmlFor=\"painting\">Enable Painting</label>\n        <input\n          id=\"painting\"\n          type=\"checkbox\"\n          checked={props.painting}\n          onChange={e => props.onChangePainting(e.target.checked)}\n        />\n      </div>\n    </>\n  );\n};\n\nconst mapStateToProps = (main: AppState) => ({\n  painting: main.settings.state === State.PAINTING,\n  settings: main.settings,\n  full: () => encodeFull(main.cells)\n});\n\nconst mapDispatchToProps = (dispatch: Dispatch<Actions>) => ({\n  onNew: () => dispatch(onNew()),\n  onChangeHighlight: (value: boolean) => dispatch(onSetHighlight(value)),\n  onChangePainting: (value: boolean) => dispatch(onChangePainting(value)),\n  doImport: (value: string) => dispatch(onImport(value))\n});\n\nexport const ConnectedControls = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Controls);\n","import { SidebarEvent, HighlightChangeEvent, ImportEvent, PaintEvent, ClearHistoryEvent } from \"./cellActions\";\nimport { SIDEBAR, NEW, HIGHLIGHT_CHANGE, IMPORT, BEGIN_PAINTING, END_PAINTING, PAINT, CLEAR_HISTORY } from \"./actionTypes\";\n\nexport function onNew() :SidebarEvent{\n    return {\n        type: SIDEBAR, \n        subtype: NEW,\n    }\n}\n\nexport function onSetHighlight(value: boolean): HighlightChangeEvent {\n    return {\n        type: HIGHLIGHT_CHANGE,\n        value,\n    }\n}\n\nexport function onImport(value: string): ImportEvent {\n    return {\n        type: IMPORT,\n        value\n    }\n}\n\nexport function onChangePainting(value: boolean): PaintEvent {\n    return {\n        type: PAINT,\n        subtype: value ? BEGIN_PAINTING: END_PAINTING,\n    }\n}\nexport function clearEvents(): ClearHistoryEvent {\n    return {\n        type: CLEAR_HISTORY,\n    }\n}","import React, { Dispatch } from \"react\";\nimport LayersClearIcon from '@material-ui/icons/LayersClear';\nimport { connect } from \"react-redux\";\nimport { AppState, CellState } from \"../state/model\";\nimport Button from \"@material-ui/core/Button\";\nimport {\n  clearEvents\n} from \"../state/sidebarActions\";\nimport { Actions } from \"../state/cellActions\";\nimport { BoardUI } from \"./Board\";\nimport { History } from './History';\nimport { ConnectedControls } from \"./sidebar/Controls\";\n\ntype SidebarProps = {\n  board: string;\n  boardCells: Array<CellState>;\n\n  clearHistory: () => void;\n};\n\n\nconst Sidebar = (props: SidebarProps) => {\n  const vfun = (e: any) => {};\n\n  return (\n    <div>\n      <ConnectedControls />\n\n      <h5>Saved Boards</h5>\n      <Button variant=\"contained\" color=\"primary\">\n        Save\n      </Button>\n      {/* <BoardUI\n        board={props.boardCells}\n        interact={false}\n        size={200}\n        onEnterNum={vfun}\n        onEnterSmallNum={vfun}\n        onDelete={vfun}\n      /> */}\n      {/* <h5>History <LayersClearIcon onClick={props.clearHistory}/></h5> */}\n      {/* <History /> */}\n      <h5>External resources</h5>\n      <a\n        href={\"https://www.sudokuwiki.org/sudoku.html?db=\" + props.board}\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n      >\n        Sudoku Wiki\n      </a>\n    </div>\n  );\n};\n\nconst encodeBoard = (cells: CellState[]) => {\n  return cells.map(x => x.mainNum || \"0\").reduce((p, n) => p + n, \"\");\n};\n\nconst mapStateToProps = (main: AppState) => {\n  return {\n    board: encodeBoard(main.cells),\n    boardCells: main.cells,\n  };\n};\n\nconst mapDispatchToProps = (dispatch: Dispatch<Actions>) => {\n  return {\n    clearHistory: () => dispatch(clearEvents()),\n  };\n};\n\nexport const ConnectedPanel = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Sidebar);\n","import React from \"react\";\nimport CSS from \"csstype\";\nimport { Hidden } from \"@material-ui/core\";\n\nexport type SkeletonProps = {\n  board: JSX.Element;\n  side: JSX.Element;\n};\n\nconst bodyStyle: CSS.Properties = {\n  display: \"flex\",\n  height: \"100vh\"\n};\n\nconst boardStyle: CSS.Properties = {\n  position: \"relative\",\n  margin:'auto',\n  padding: \"20px\"\n};\n\nconst sidebarStyle: CSS.Properties = {\n  position: 'relative',\n  padding: \"20px\",\n  width: \"22%\",\n  minWidth: \"270px\",\n  minHeight: '100vh',\n  maxHeight: '100vh',\n  overflowY: 'scroll'\n};\n\nconst collapse: CSS.Properties = {\n  right: '-15px',\n  top: '50vh',\n  display: 'none',\n  position: 'absolute',\n  padding: '10px',\n  borderTopRightRadius: '15px',\n  borderBottomRightRadius: '15px'\n}\n\nconst rel: CSS.Properties = {\n  position: 'relative'\n}\n\nexport class Skeleton extends React.PureComponent<SkeletonProps> {\n  render() {\n    return (\n      <div style={bodyStyle}>\n        <div style={rel}>\n          <span style={collapse}>X</span>\n          <div style={sidebarStyle}>\n            {this.props.side}\n          </div>\n        </div>\n        <div style={boardStyle}>{this.props.board}</div>\n      </div>\n    );\n  }\n}\n","import React, { Dispatch, SyntheticEvent } from \"react\";\nimport { AppState } from \"../state/model\";\nimport { connect } from \"react-redux\";\nimport { Actions, resize } from \"../state/cellActions\";\nimport { ResizableBox, ResizeCallbackData } from \"react-resizable\";\nimport { RESIZE_START, RESIZE_END } from \"../state/actionTypes\";\n\ntype ResizePanelProps = {\n  size: number;\n  children: Array<JSX.Element>;\n  onDrag: (arg0: SyntheticEvent, data: ResizeCallbackData) => void;\n  onDragStart: (arg0: SyntheticEvent, data: ResizeCallbackData) => void;\n  onDragEnd: (arg0: SyntheticEvent, data: ResizeCallbackData) => void;\n};\n\nfunction ResizePanelUI(props: ResizePanelProps): JSX.Element {\n  return (\n    <ResizableBox\n      width={props.size}\n      height={props.size}\n      minConstraints={[450, 450]}\n      lockAspectRatio={true}\n      onResize={props.onDrag}\n      onResizeStart={props.onDragStart}\n      onResizeStop={props.onDragEnd}\n    >\n      {props.children}\n    </ResizableBox>\n  );\n}\n\nconst mapStateToProps = (main: AppState) => {\n  return {\n    size: main.settings.boardSize\n  };\n};\n\nconst mapDispatchToProps = (dispatch: Dispatch<Actions>) => {\n    return {\n        onDrag: (e: SyntheticEvent, data: ResizeCallbackData) => {\n            dispatch(resize(data.size.width))\n        },\n        onDragStart: (e: SyntheticEvent, data: ResizeCallbackData) => {\n            dispatch({\n                type: RESIZE_START\n            })\n        },\n        onDragEnd: (e: SyntheticEvent, data: ResizeCallbackData) => {\n            dispatch({\n                type: RESIZE_END\n            })\n        }\n    }\n}\n\nexport const ResizePanel = connect(mapStateToProps, mapDispatchToProps)(ResizePanelUI);\n","import { Coordinate } from \"../../state/model\";\n\nexport const getSmallCoordinatesFromXY = (\n  size: number,\n  x: number,\n  y: number\n): Coordinate => {\n  const cell = size / 9;\n  const subcell = cell / 3;\n  const xAccrossCell = Math.floor(x / cell);\n  const yAccrossCell = Math.floor(y / cell);\n  const finalCell = yAccrossCell * 9 + xAccrossCell;\n\n  const xAccrossSubCell = Math.floor((x / subcell) % 3);\n  const yAccrossSubCell = Math.floor((y / subcell) % 3);\n  const finalSub = yAccrossSubCell * 3 + xAccrossSubCell;\n  return {\n    cell: finalCell,\n    subcell: finalSub\n  };\n};\n\nexport const toCoordinates = (size: number, coords: Coordinate) => {\n  const { cell, subcell } = coords;\n  const largeSize = size / 9;\n  const smallSize = largeSize / 3;\n  // to find out the X we need the cell mod 9\n  let xAccross = (cell % 9) * largeSize;\n  xAccross += (subcell % 3) * smallSize + smallSize / 2;\n  let yAccross = Math.floor(cell / 9) * largeSize;\n  yAccross += Math.floor(subcell / 3) * smallSize + smallSize / 2;\n  return [xAccross, yAccross];\n};\n\nexport const snapTo = (size: number, x: number, y: number) => {\n  // snap to the closest\n  let spacing = size / (9 * 3);\n  let snap = spacing;\n\n  const x1 = Math.round((x - spacing * 0.5) / snap) * snap + spacing * 0.5;\n  const y1 = Math.round((y - spacing * 0.5) / snap) * snap + spacing * 0.5;\n\n  return [x1, y1];\n};\n","import { Coordinate } from \"../../state/model\";\nimport { toCoordinates } from \"../size/sizer\";\nimport React from \"react\";\n\nexport const Line = ({\n  start,\n  end,\n  seen,\n  size\n}: {\n  start: Coordinate;\n  end: Coordinate;\n  seen: Set<Coordinate>;\n  size: number;\n}) => {\n  const seenStart = seen.has(start);\n  const seenEnd = seen.has(end);\n  const startCoords = toCoordinates(size, start);\n  const endCoords = toCoordinates(size, end);\n  const boxSize = size / 9 / 4;\n  const centerStartX = startCoords[0] - boxSize / 2;\n  const centerStartY = startCoords[1] - boxSize / 2;\n  const centerEndX = endCoords[0] - boxSize / 2;\n  const centerEndY = endCoords[1] - boxSize / 2;\n  const startNode = seenStart ? null : (\n    <rect\n      x={centerStartX}\n      y={centerStartY}\n      width={boxSize * 0.8}\n      height={boxSize * 0.9}\n      fill=\"rgba(174, 214, 157, 0.2)\"\n      style={{ pointerEvents: \"none\" }}\n    />\n  );\n  const endNode = seenEnd ? null : (\n    <rect\n      x={centerEndX}\n      y={centerEndY}\n      width={boxSize * 0.8}\n      height={boxSize * 0.9}\n      fill=\"rgba(245, 240, 129, 0.2)\"\n      style={{ pointerEvents: \"none\" }}\n    />\n  );\n\n  const midPointX = (startCoords[0] + endCoords[0]) / 2;\n  const midPointY = (startCoords[1] + endCoords[1]) / 2;\n  // const rise = Math.abs(midPointY - endCoords[1]);\n  // const run = Math.abs(midPointX - endCoords[0]);\n  // const angle = -run / rise;\n  return (\n    <g>\n      <path\n        d={`M ${startCoords[0]} ${startCoords[1]} Q ${midPointX} ${midPointY}\n        ${endCoords[0]} ${endCoords[1]}`}\n        fill=\"transparent\"\n        stroke=\"#0000ffaa\"\n        style={{ pointerEvents: \"none\" }}\n      />\n      {startNode}\n      {endNode}\n    </g>\n  );\n};\n","import React, { useState, Dispatch } from \"react\";\nimport CSS from \"csstype\";\nimport { connect } from \"react-redux\";\nimport { AppState, Coordinate, Link, CellState } from \"../../state/model\";\nimport {\n  getSmallCoordinatesFromXY,\n  toCoordinates,\n  snapTo\n} from \"../size/sizer\";\nimport { Line } from \"./Line\";\n\nconst defaultStyle: CSS.Properties = {\n  position: \"absolute\",\n  zIndex: 2\n};\n\nconst lineStyle: CSS.Properties = {\n  pointerEvents: \"none\",\n  stroke: \"green\"\n};\n\nexport type PaintProps = {\n  size: number;\n  board: Array<CellState>;\n};\n\ntype LineCoordinates = {\n  start: Coordinate;\n  end: Coordinate;\n};\ntype OngoingLine = {\n  start: Coordinate;\n  x: number;\n  y: number;\n} | null;\n\nexport const PaintUI = (props: PaintProps) => {\n  const { size } = props;\n\n  const [lineState, setLineState] = useState<Array<LineCoordinates>>([]);\n  const [ongoingLine, setOngoingLine] = useState<OngoingLine>(null);\n\n  const lines = lineState.map(x => (\n    <Line seen={new Set()} size={size} start={x.start} end={x.end} />\n  ));\n  let ongoing = <></>;\n  if (ongoingLine) {\n    const [x, y] = toCoordinates(size, ongoingLine.start);\n    ongoing = (\n      <path\n        d={`M ${x} ${y} L ${ongoingLine.x} ${ongoingLine.y}`}\n        style={lineStyle}\n      />\n    );\n  }\n\n  return (\n    <svg\n      width={props.size}\n      height={props.size}\n      style={defaultStyle}\n      onClick={onSvgClick(\n        size,\n        props.board,\n        setLineState,\n        setOngoingLine,\n        lineState,\n        ongoingLine\n      )}\n      onMouseMove={onMove(size, setOngoingLine, ongoingLine)}\n    >\n      {lines}\n      {ongoing}\n    </svg>\n  );\n};\n\ntype SvgClick = React.MouseEvent<SVGElement>;\ntype StateDispatch<T> = Dispatch<React.SetStateAction<T>>;\n\nconst onMove = (\n  size: number,\n  setOngoingLine: StateDispatch<OngoingLine>,\n  ongoingLine: OngoingLine\n) => (e: SvgClick) => {\n  if (!(e.target instanceof SVGElement)) {\n    return;\n  }\n  if (ongoingLine?.start) {\n    const rect = e.target.getBoundingClientRect();\n    const [x, y] = snapTo(size, e.clientX - rect.left, e.clientY - rect.top);\n    setOngoingLine({\n      ...ongoingLine,\n      x,\n      y\n    });\n  }\n};\n\nconst onSvgClick = (\n  size: number,\n  board: Array<CellState>,\n  setLineState: StateDispatch<Array<Link>>,\n  setOngoingLine: StateDispatch<OngoingLine>,\n  lineState: Array<Link>,\n  ongoingLine: OngoingLine\n) => (e: SvgClick) => {\n  if (ongoingLine == null) {\n    return startLine(size, e, setOngoingLine, board);\n  } else {\n    // then we're looking for a second click\n    return commitLine(\n      size,\n      e,\n      ongoingLine,\n      lineState,\n      setOngoingLine,\n      setLineState,\n      board\n    );\n  }\n};\n\nconst commitLine = (\n  size: number,\n  e: SvgClick,\n  line: OngoingLine,\n  lines: Array<Link>,\n  setLine: StateDispatch<OngoingLine>,\n  setLines: StateDispatch<Array<Link>>,\n  board: Array<CellState>\n) => {\n  if (!(e.target instanceof SVGElement)) {\n    return;\n  }\n\n  const target = e.target;\n  const rect = target.getBoundingClientRect();\n  const [x, y] = snapTo(size, e.clientX - rect.left, e.clientY - rect.top);\n  const coord: Coordinate = getSmallCoordinatesFromXY(size, x, y);\n  const small = board[coord.cell].small;\n  const correctClick = small.indexOf(coord.subcell + 1) !== -1;\n  if (correctClick && line !== null) {\n    // commit the click and reset the line\n    const next: Link = {\n      start: line.start,\n      end: coord\n    };\n    setLines([...lines, next]);\n    setLine(null);\n  }\n};\n\nconst startLine = (\n  size: number,\n  e: SvgClick,\n  setLine: StateDispatch<OngoingLine>,\n  board: Array<CellState>\n) => {\n  if (!(e.target instanceof SVGElement)) {\n    return;\n  }\n  const target = e.target;\n  const rect = target.getBoundingClientRect();\n  const [x, y] = snapTo(size, e.clientX - rect.left, e.clientY - rect.top);\n  const coord = getSmallCoordinatesFromXY(size, x, y);\n  const small = board[coord.cell].small;\n  const correctClick = small.indexOf(coord.subcell + 1) !== -1;\n  if (correctClick) {\n    setLine({\n      start: coord,\n      x: x,\n      y: y\n    });\n  }\n};\n\nconst mapStateToProps = (state: AppState) => {\n  return {\n    size: state.settings.boardSize,\n    board: state.cells\n  };\n};\n\nexport const Paint = connect(mapStateToProps)(PaintUI);\n","import React from \"react\";\nimport { Paint } from \"./paint/Painter\";\nimport { connect } from \"react-redux\";\nimport { AppState, State } from \"../state/model\";\n\nexport type Paint = {\n  cell: number;\n  subcell: number;\n  color_start: string;\n  color_end: string;\n  color_line: string;\n};\n\nexport type PaintManagerProps = {\n  size: number;\n  enabled: boolean;\n};\n\nexport const PaintManager = (props: PaintManagerProps) => {\n  const { enabled } = props;\n  if (!enabled) {\n    return <></>;\n  }\n  const painter = <Paint />;\n  return <div>{painter}</div>;\n};\n\nconst mapStateToProps = (state: AppState) => ({\n  enabled: state.settings.state === State.PAINTING,\n  size: state.settings.boardSize\n});\n\nexport const ConnectedPainter = connect(mapStateToProps)(PaintManager);\n","import React from \"react\";\nimport \"./App.css\";\nimport { ToastProvider } from \"react-toast-notifications\";\nimport { FilteredBoard } from \"./ui/Board\";\nimport { store } from \"./state/store\";\nimport { Provider } from \"react-redux\";\nimport { ConnectedPanel } from \"./ui/SidePanel\";\nimport { Skeleton } from \"./ui/Skeleton\";\nimport { ResizePanel } from \"./ui/ResizeablePanel\";\nimport { ConnectedPainter } from \"./ui/PaintManager\";\n\nconst App: React.FC = () => {\n  const Mainboard = (\n    <ResizePanel>\n      <ConnectedPainter />\n      <FilteredBoard />\n    </ResizePanel>\n  );\n\n  return (\n    <Provider store={store}>\n      <ToastProvider>\n        <Skeleton board={Mainboard} side={<ConnectedPanel />} />\n      </ToastProvider>\n    </Provider>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n"],"sourceRoot":""}